<?php

namespace App\Models;

use Carbon\Carbon;
use Illuminate\Database\Eloquent\Model;

class Exploitant extends Model
{
    //
    protected $guarded = [];
    protected $dates = ['dtn','date_expiration','date_adhesion'];

    public function zone()
    {
        return $this->belongsTo('App\Models\Zone');
    }

    public function village()
    {
        return $this->belongsTo('App\Models\Village');
    }
    /* public function niveau()
    {
        return $this->belongsTo('App\Models\Niveau');
    } */
    public function gic()
    {
        return $this->belongsTo('App\Models\Gic');
    }

    public function agent(){
        return $this->belongsTo('App\Models\Agent');
    }

    public function cooperative()
    {
        return $this->belongsTo('App\Models\Cooperative');
    }

    public function formations()
    {
        return $this->belongsToMany('App\Models\Formation','exploitant_formations');
    }



    public function activites()
    {
        return $this->belongsToMany('App\Models\Activite','formation_activite');
    }

    public function parcelles(){
        return $this->hasMany('App\Models\Parcelle');
    }

    public  function getNameAttribute(){
        return $this->last_name . "  ".$this->first_name;
    }

    public function getNiveauAttribute(){
        $nv = "PRIMAIRE";
        if($this->niveau_id==2){
            $nv = "SECONDAIRE";
        }
        if($this->niveau_id==2){
            $nv = "UNIVERSITAIRE";
        }

        return $nv;
    }

    public function getAgeAttribute(){
       return $this->dtn? Carbon::parse($this->dtn)->diff(Carbon::now())->y:0;
    }

}
